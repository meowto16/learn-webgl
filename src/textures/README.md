# Текстуры

## Шаги

1. Заменяем 3D R,G,B цвет на 2D UV-координаты.
   1. UV mapping - это 3D modelling процесс, проецирования 2D изображения на 3D модель.
   2. UV координаты - это 2D координаты точки на изображении
   3. U и V точки - от 0 до 1
   4. U=0 V=0 - это левая верхняя точка, U=1 V=1 - правая нижняя точка соответственно

2. Создаем семплера для шейдеров. 
   1. `sampler2D` - позволяет нам ссылаться на текстуру. Это некий канал данных
   2. `texture2D` - вызывается, чтобы узнать цвет пикселя на текстуре.
   3. Шейдер может одновременно обращаться к нескольким семплерам.
      1. Максимальное количество семплеров зависит от видеокарты. Обычно 16, но на старых компах может быть и 4, 
         так что лучше не превышать 8
   4. Семплер - это не простой канал данных. Параметризация 
      1. Texel - Texture Pixel. Именно они семплятся и превращаются в рендер пиксели, который посылается в фрагмент шейдер
      2. Когда текстурный объект далеко - каждый рендер пиксель будет соответствовать множеству текселей
      
3. Задаем метод минификации текстуры
   1. `GL.LINEAR` - недостаточно, чтобы получить плавный рендер, он будет зернистый
   2. Также это будет существенно влиять на производительность. Фетч текселя в фрагмент шейдере - медленная операция.
   3. К счастью, когда тексель фетчится в фрагмент шейдере, все тексели в 2D по соседству автоматически
      перемещаются в быстрый кэш, так что фетчить их можно будет очень быстро
   4. Так что если мы фетчим последовательно тексели для последовательной отрисовки рендер пикселей, рендер будет оптимальным
      и быстрым, так как здесь высокая связность кэша.
   5. Но если мы фетчим тексели далекие от последовательно отрендеренных пикселей, производительность упадет.
   6. `GL.NEAREST` - быстрее, но производит эффект мигания. Берет ближайший тексель, вместо линейной интерполяции

4. Делаем мипмапу и меняем метод минификации текстуры
   1. Мипмаппинг состоит из расчета уровней мипмапы изображения, что является сокращением 2n изображения
   2. Мипмап уровень 0 - это оригинальное изображение
   3. Мипмапы как раз используются для сэмплинга

## Чуть подробнее

### Мипмапы

**Мипмапы (MipMaps) или Мип-карты**  — предрассчитанный, оптимизированный набор изображений связанных с одной текстурой и 
предназначенный для увеличения скорости рендеринга и улучшения качества изображения.

Каждое следующее изображение в наборе вдвое меньше предыдущего. То есть самое первое имеет размер равный размеру 
текстуры, второе вдвое меньший, третье — вчетверо и т.д. до размера 1х1 тексель.

Смысл такого вот предрассчитанного набора состоит в том, что при текстурировании будет выбираться изображение 
с наиболее подходящим размером.

**Пример:**

На модель натянута текстура размером 1024х1024. Модель стоит далеко от камеры и геометрические размеры на 
экране у нее малы (скажем 3 пикселя).

- При отключенном мипмапинге видеокарте придётся выбирать, какой тексель из большой текстуры будет 
  использован для расчёта цвета точки. Этот выбор может меняться при изменении ракурса камеры, что приведёт к мерцанию объектов вдали.
- При включенном мипмапинге видеокарта выберет более подходящий размер текстуры, и будет производить выборку из него, 
  что избавит нас от артефактов изображения.

Генерацию мип-уровней можно сделать несколькими способами:
- Самое простое, это указать видеокарте сгенерировать мип-уровни, но качество не будет очень хорошим, так как 
  для генерации, скорее всего, будет использоваться простой Box фильтр.
- Другой вариант - генерировать самому через свои фильтры. Смотря какой фильтр даст лучшую картинку
- Последний вариант - требует намного больше труда - рисовать самому вручную.

Надо отметить, что мип-текстурирование имеет некоторые ограничения: используемые изображения должны иметь размеры, 
которые равны степени двойки. Например, 16px, 32px, 64px, 128px и т.д. 
При этом необязательно, чтобы высота и ширина были равные, главное, чтобы их значения были равны степени двойки.

## Методы

### GL.uniform[1234][fi][v]()

#### Описание

Используется для задания значений `uniform` переменным

#### Параметры

##### - location

`WebGLUniformLocation` - объект, содержащий адрес `uniform` атрибута, который надо изменить

##### - value, v0, v1, v2, v3

Новое значение, задаваемое `uniform` переменной

### GL.